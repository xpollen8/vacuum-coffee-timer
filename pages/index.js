import Head from '../components/head'
import Nav from '../components/nav'
import Sound from 'react-sound'

const countdownFrom = 90;

const Cup = ({ label, onClick }) => {
  const lab = label.split(' ').map((w,i) => { return <tspan key={i} x={39 + i} dy={5}>{w}</tspan>});
  return (
    <svg xmlns="http://www.w3.org/2000/svg" version="1.1" x="0px" y="0px" viewBox="0 0 100 100"
      onClick={onClick}>
      <path d="M66.2,45.5c-0.6-2.3-3-3.8-5.4-3.4l-2.3,0.3l0.6-4.2c0.1-0.5-0.1-1-0.4-1.4c-0.3-0.4-0.8-0.6-1.4-0.6H46.6h-0.5H35.5  c-0.5,0-1,0.2-1.4,0.6c-0.3,0.4-0.5,0.9-0.4,1.4l0.6,4.3c0.1,1,0.2,2,0.2,3.1l0,6.7c0,1-0.1,2.1-0.2,3.1L34,57.6  c-0.1,1.2-0.2,2.4-0.2,3.6v1.2c0,0.8,0.6,1.4,1.4,1.4h10.9h0.5h10.9c0.8,0,1.4-0.6,1.4-1.4v-1.2c0-1.2-0.1-2.4-0.2-3.6l-0.1-0.7  c1.3-0.6,2.5-1.5,3.4-2.7l3.4-4.6C66.3,48.4,66.6,46.9,66.2,45.5z M57.7,62.4c0,0.1-0.1,0.2-0.2,0.2H46.6h-0.5H35.2  c-0.1,0-0.2-0.1-0.2-0.2v-1.2c0-1.2,0.1-2.3,0.2-3.5l0.3-2.2c0.1-1.1,0.2-2.2,0.2-3.3l0-6.7c0-1.1-0.1-2.2-0.2-3.2L34.8,38  c0-0.2,0-0.4,0.1-0.5c0.1-0.1,0.3-0.2,0.5-0.2h10.6h0.5h10.6c0.2,0,0.3,0.1,0.5,0.2c0.1,0.1,0.2,0.3,0.1,0.5l-0.6,4.3  c-0.1,1.1-0.2,2.1-0.2,3.2l0,6.7c0,1.1,0.1,2.2,0.2,3.3l0.3,2.2c0.1,1.1,0.2,2.3,0.2,3.5V62.4z M64.4,48.9L61,53.5  c-0.7,0.9-1.6,1.6-2.6,2.1l0-0.3c-0.1-1-0.2-2.1-0.2-3.1l0-6.7c0-0.6,0-1.3,0.1-1.9l2.6-0.4c1.9-0.3,3.7,0.8,4.1,2.5  C65.3,46.9,65.1,48,64.4,48.9z">
      </path>
      <text y="41px" fontSize="4">
        {lab}
      </text>
    </svg>
  )
}

const Brew = ({ state }) => {
  return (
    <div>
    <style>{`
      .svg path {
        fill: #999;
      }
      .unit path {
      }
      .base-covered path, circle {
        display: block;
      }
      .base-uncovered path, circle {
        display: block;
      }
      .bubbles path {
        fill: #eee;
        animation       : bubbles-moving 1s infinite;
        transform-origin: center bottom;
      }
      .steam circle {
        fill: #eee;
        animation       : steam-moving 5s linear infinite;
        transform-origin: center bottom;
      }
      .flame path {
        stroke: #ffa500;
        stroke-width: 3;
        stroke-miterlimit: 10;
        fill: #d84437;
        animation       : flame-moving .15s ease infinite;
        transform-origin: center bottom;
      }
      .coffee-upper path {
        fill: #333;
        transform: translateY(-245px);
      }
      .base-uncovered .coffee-upper path {
        fill: #333;
        transform: translateY(-245px);
      }
      .base-covered .coffee-lower path {
        fill: #eee;
      }
      .upper-bowl path {
      }
      @keyframes flame-moving {
        0%   {transform: scale(1, 1.13)}
        50%  {transform: scale(.8, 1.15)}
        100% {transform: scale(1, 1.13)}
      }
      @keyframes bubbles-moving {
        0%   {transform: translate(0, 0%)}
        100%  {transform: translate(0, -1500%)}
      }
      @keyframes steam-moving {
        0%   {transform: translate(0, 0%)}
        100%  {transform: translate(0, -1500%)}
      }

    `}</style>
    <svg className="svg" version="1.1" xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" 
       viewBox="0 0 792 612" enableBackground="new 0 0 792 612">
      <g className="upper-bowl">
        <path d="M286.452,170.748l40.392,25.704c1.224,0.612,1.836,2.448,1.836,3.672v4.896h-7.956
          c-1.836,0-3.672,1.836-3.672,3.672s1.836,3.672,3.672,3.672h70.992c1.836,0,3.672-1.836,3.672-3.672s-1.836-3.672-3.672-3.672
          h-7.956v-4.896c0-1.836,0.612-3.06,1.836-3.672l40.392-25.704c14.688-9.18,23.256-25.092,22.644-42.228l-1.836-104.04L457.2,7.956
          c0.611-1.224,0.611-2.448,0-3.672c-0.612-1.224-1.836-1.836-3.061-1.836H258.3c-1.224,0-2.448,0.612-3.06,1.836
          c-0.612,1.224-0.612,2.448,0,3.672l9.18,16.524l-1.224,104.04C263.196,145.656,271.764,161.568,286.452,170.748z M362.34,129.132
          c0.612,1.224,0.612,1.836,0.612,3.06c0,4.284-3.06,7.344-7.344,7.344c-4.284,0-7.344-3.06-7.344-7.344
          c0-1.224,0.612-2.448,0.612-3.06H362.34z M355.608,146.88c1.224,0,1.836,0,3.06,0v41.616h-6.12V146.88
          C353.772,146.88,354.996,146.88,355.608,146.88z M366.624,195.84v9.18h-22.032v-9.18H366.624z M264.42,9.792h182.988l-7.344,11.628
          c-0.612,0.612-0.612,1.224-0.612,1.836l1.224,105.264c0,14.688-7.344,28.152-19.584,36.108L380.7,190.332
          c-3.672,2.448-5.508,6.12-5.508,9.792v4.896h-1.224v-12.852c0-1.836-1.836-3.672-3.672-3.672h-4.284V143.82v-0.612
          c3.06-2.448,4.284-6.12,4.284-10.404c0-3.672-1.224-6.732-3.06-9.18l0,0l-0.612-0.612c0,0-0.612,0-0.612-0.612H365.4h-0.612l0,0
          H347.04l0,0h-0.612h-0.612c0,0-0.612,0-0.612,0.612c0,0-0.612,0-0.612,0.612l0,0c-2.448,2.448-3.06,6.12-3.06,9.18
          c0,4.284,1.836,7.956,4.284,10.404v0.612v44.676h-4.896c-1.836,0-3.672,1.836-3.672,3.672v12.852h-1.224v-4.896
          c0-4.284-1.836-7.956-5.508-9.792l-40.392-25.704c-12.24-7.956-19.584-21.42-19.584-36.108l1.224-105.264
          c0-0.612,0-1.224-0.612-1.836L264.42,9.792z"/>
      </g>
      <g className="unit">
        <path d="M359.28,435.132c21.42-1.224,41.004-11.628,54.468-27.54h-116.28
          C312.156,424.728,334.188,435.744,359.28,435.132z"/>
        <path d="M536.76,397.8C536.76,397.8,536.76,397.188,536.76,397.8c0.612-0.612,0.612-1.224,1.225-1.836v-0.612l0,0
          l0,0l0,0c0-0.611,0-0.611,0-1.224l0,0c0-0.612-0.612-0.612-0.612-1.224l0,0l-7.344-6.12l-4.896-89.352h3.061l0,0
          c1.836,0,3.672-1.836,3.672-3.672c0-1.224-0.612-2.448-1.836-3.06l-6.12-6.12v-12.24v-0.612
          c-0.612-27.54-22.645-49.572-50.185-49.572H438.84v-4.284c0-1.224-0.612-3.06-2.448-3.672c-1.224-0.612-3.06,0-4.283,0.612
          l-5.509,5.508c-0.611,0.612-1.224,0.612-1.836,0.612h-7.344v-4.896c0-1.836-1.836-3.672-3.672-3.672s-3.672,1.836-3.672,3.672
          v4.284h-9.792c-0.612,0-1.225,0-1.836-0.612l-6.732-3.672c-1.836-1.224-3.672-1.836-5.508-1.836h-53.244
          c-5.508,0-10.404,4.896-10.404,10.404v17.748c0,4.896,3.06,8.568,7.344,9.792v21.42c0,0.612-0.612,1.224-1.224,1.224
          c-37.332,11.628-63.648,46.512-63.648,85.68c0,24.48,9.792,47.736,27.54,64.872c17.136,15.912,38.556,25.092,61.812,25.092
          c1.224,0,3.06,0,4.284,0c45.9-2.447,83.232-39.779,85.068-85.68c1.836-41.004-24.48-78.336-63.648-89.964
          c-0.612,0-1.224-0.612-1.224-1.224v-20.808h5.508c1.836,0,3.672-0.612,5.508-1.224l6.732-3.672c0.611,0,1.224-0.612,1.836-0.612
          h9.792v2.448c0,1.836,1.836,3.672,3.672,3.672s3.672-1.836,3.672-3.672v-2.448h7.344c0.612,0,1.836,0,1.836,0.612l5.508,5.508
          c0.612,0.612,1.836,1.224,2.448,1.224s1.225,0,1.225,0c1.224-0.612,2.447-1.836,2.447-3.672v-3.672h34.885
          c13.464,0,24.479,11.016,24.479,23.868v0.612v12.24l-6.732,6.732c-1.224,1.224-1.224,2.448-0.611,4.284
          c0.611,1.224,1.836,2.448,3.672,2.448h3.06l-4.896,89.352l-7.344,6.12l0,0c-0.612,0.611-0.612,0.611-0.612,1.224l0,0
          c0,0.612,0,0.612,0,1.224l0,0l0,0l0,0v0.612c0,0.612,0.612,1.224,0.612,1.836l0,0l0,0l5.508,5.508L481.68,529.38
          c0,1.836,0.612,3.672,1.836,5.508c1.225,1.225,3.061,2.448,5.509,2.448h41.615c1.836,0,3.673-0.612,5.509-2.448
          c1.224-1.224,1.836-3.672,1.836-5.508l-6.732-126.072L536.76,397.8L536.76,397.8z M503.712,287.64
          c0.612-0.612,1.224-1.836,1.224-2.448V275.4h11.629v10.404c0,1.224,0.611,1.836,1.224,2.448l1.836,1.836h-17.136L503.712,287.64z
           M379.476,281.52c36.108,11.016,59.976,44.676,58.14,82.62c-1.836,42.229-36.108,76.5-78.336,78.336
          c-22.644,1.225-44.064-6.731-60.588-22.644s-25.704-36.72-25.704-59.364c0-36.107,23.868-68.544,58.14-78.948
          c3.672-1.224,6.12-4.284,6.12-7.956v-20.808h7.344v115.057c0,1.836,1.836,3.672,3.672,3.672c1.836,0,3.672-1.836,3.672-3.672
          V252.756h6.12v115.056c0,1.837,1.836,3.673,3.672,3.673s3.672-1.836,3.672-3.673V252.756h7.344v20.808
          C373.356,277.236,375.804,280.296,379.476,281.52z M399.672,239.292c-1.836,0-3.672,0.612-5.508,1.224l-6.12,4.284
          c-0.612,0-1.224,0.612-1.836,0.612h-53.244c-1.836,0-3.06-1.224-3.06-3.06v-17.748c0-1.836,1.224-3.06,3.06-3.06h53.244
          c0.612,0,1.224,0,1.836,0.612l6.732,3.672c1.836,1.224,3.672,1.836,5.508,1.836h9.792v11.628H399.672L399.672,239.292z
           M424.152,239.292h-7.345v-11.628h7.345c2.447,0,4.896-0.612,6.731-2.448v16.524C429.048,240.516,426.6,239.292,424.152,239.292z
           M473.112,239.292h-34.885v-11.016h34.885c22.644,0,41.004,17.136,42.84,39.168h-11.017
          C502.488,252.144,489.024,239.292,473.112,239.292z M517.176,296.82l4.896,91.188c0,1.225,0.611,1.836,1.224,2.448l1.224,1.224
          h-28.764l1.225-1.224c0.611-0.612,1.224-1.836,1.224-2.448l4.896-91.188H517.176z M490.248,529.38l6.732-127.908
          c0-1.224-0.612-1.836-1.225-3.06l0,0h29.376l0,0c-0.612,0.612-1.224,1.836-1.224,3.06l6.731,127.908H490.248z"/>
        <g className="coffee-lower">
          <path d="M359.28,435.132c21.42-1.224,41.004-11.628,54.468-27.54h-116.28
            C312.156,424.728,334.188,435.744,359.28,435.132z"/>
        </g>
      </g>
      {state === 'ready' &&
      <g className="base-covered">
        <path d="M531.252,540.396h-41.616c-1.836,0-3.672,1.836-3.672,3.672s1.836,3.672,3.672,3.672h5.508v32.436
          l-81.396,4.284c3.06-4.896,4.896-11.016,4.896-16.524c0-17.136-15.3-32.436-39.78-38.556c-3.672-0.612-6.12-3.672-6.12-7.344
          v-4.284h7.344c1.224,0,1.836-0.612,2.448-1.224c0.612-0.612,1.224-1.836,1.224-3.061l-4.896-48.96
          c-0.612-6.12-6.12-11.016-12.24-11.016h-21.42c-6.12,0-11.016,4.896-11.628,11.016l-4.896,48.96c0,1.225,0,1.836,1.224,3.061
          c0.612,0.611,1.836,1.224,2.448,1.224h7.344v4.284c0,3.672-2.448,6.731-6.12,7.344c-23.868,6.12-39.78,21.42-39.78,38.556
          c0,7.956,3.672,15.912,9.792,22.645l-26.928,1.224c-1.836,0-3.672,1.836-3.672,3.672v10.404c0,1.836,1.836,3.672,3.672,3.672h67.32
          h24.48h151.164c1.836,0,3.672-1.836,3.672-3.672v-58.14h7.956c1.836,0,3.672-1.836,3.672-3.672S533.088,540.396,531.252,540.396z
           M340.308,465.732c0-2.448,2.448-4.284,4.896-4.284h21.42c2.448,0,4.896,1.836,4.896,4.284l4.896,44.676h-40.392L340.308,465.732z
           M300.528,568.548c0-13.464,13.464-26.315,34.272-31.824c6.732-1.836,11.628-7.956,11.628-14.688v-4.284h6.12v32.437
          c0,17.136-11.628,23.256-22.032,23.256c-1.836,0-3.672,1.836-3.672,3.672s1.836,3.672,3.672,3.672
          c14.076,0,29.376-9.792,29.376-30.6v-32.437h6.12v4.284c0,6.731,4.896,12.852,11.628,14.688
          c20.196,5.509,34.272,17.748,34.272,31.824c0,6.12-2.448,11.628-7.344,17.136l-89.964,4.896
          C305.424,584.46,300.528,576.504,300.528,568.548z M343.368,602.208H279.72v-2.448l125.459-6.731l0,0l89.353-4.896v14.076H367.848
          H343.368z M515.34,602.208h-13.464V547.74h13.464V602.208z"/>
      </g>
      }
      {state === 'counting' &&
      <g className="base-uncovered">
        <path d="M531.252,540.396h-41.616c-1.836,0-3.672,1.836-3.672,3.672s1.836,3.672,3.672,3.672h5.508v32.436
          l-81.396,4.284c3.06-4.896,4.896-11.016,4.896-16.524c0-17.136-15.3-32.436-39.78-38.556c-3.672-0.612-6.12-3.672-6.12-7.344
          v-4.284h7.344c1.224,0,1.836-0.612,2.448-1.224c0.612-0.612,1.224-1.836,1.224-3.061l-4.896-9.577
          c-0.612-6.12-6.12-11.016-12.24-11.016h-21.42c-6.12,0-11.016,4.896-11.628,11.016l-4.896,9.577c0,1.225,0,1.836,1.224,3.061
          c0.612,0.611,1.836,1.224,2.448,1.224h7.344v4.284c0,3.672-2.448,6.731-6.12,7.344c-23.868,6.12-39.78,21.42-39.78,38.556
          c0,7.956,3.672,15.912,9.792,22.645l-26.928,1.224c-1.836,0-3.672,1.836-3.672,3.672v10.404c0,1.836,1.836,3.672,3.672,3.672h67.32
          h24.48h151.164c1.836,0,3.672-1.836,3.672-3.672v-58.14h7.956c1.836,0,3.672-1.836,3.672-3.672S533.088,540.396,531.252,540.396z
           M336.024,510.408l4.284-5.293c0-2.448,2.525-4.284,4.896-4.284h21.42c2.448,0,4.896,1.836,4.896,4.284l4.896,5.293H336.024z
           M300.528,568.548c0-13.464,13.464-26.315,34.272-31.824c6.732-1.836,11.628-7.956,11.628-14.688v-4.284h6.12v0.009h7.344v-0.009
          h6.12v4.284c0,6.731,4.896,12.852,11.628,14.688c20.196,5.509,34.272,17.748,34.272,31.824c0,6.12-2.448,11.628-7.344,17.136
          l-89.964,4.896C305.424,584.46,300.528,576.504,300.528,568.548z M494.532,602.208H367.848h-24.48H279.72v-2.448l125.459-6.731
          l89.353-4.896V602.208z M515.34,602.208h-13.464V547.74h13.464V602.208z"/>
        <path d="M330.516,573.444c-1.836,0-3.672,1.836-3.672,3.672s1.836,3.672,3.672,3.672
          c14.076,0,29.376-9.792,29.376-30.6v-61.354h-7.344v61.354C352.548,567.324,340.92,573.444,330.516,573.444z"/>
        <g className="flame">
          <path d="M343,477.666
            c0,8.39,27,7.29,27-0.059s-13.661-12.44-13.661-12.44S343,472.169,343,477.666z"/>
        </g>
        <g className="steam">
          <circle cx="321.336" cy="145.044" r="3.672"/>
          <circle cx="305.424" cy="145.044" r="3.672"/>
          <circle cx="290.124" cy="145.044" r="3.672"/>
          <circle cx="389.88" cy="145.044" r="3.672"/>
          <circle cx="405.792" cy="145.044" r="3.672"/>
          <circle cx="421.704" cy="145.044" r="3.672"/>
          <circle cx="312.156" cy="129.744" r="3.672"/>
          <circle cx="296.856" cy="129.744" r="3.672"/>
          <circle cx="329.292" cy="129.744" r="3.672"/>
          <circle cx="399.06" cy="129.744" r="3.672"/>
          <circle cx="381.924" cy="129.744" r="3.672"/>
          <circle cx="414.972" cy="129.744" r="3.672"/>
          <circle cx="329.292" cy="160.344" r="3.672"/>
          <circle cx="313.38" cy="160.344" r="3.672"/>
          <circle cx="381.924" cy="160.344" r="3.672"/>
          <circle cx="397.836" cy="160.344" r="3.672"/>
        </g>
        <g className="bubbles">
          <path d="M355.608,402.084c2.448,0,4.284-1.836,4.284-4.284l0,0c0-2.448-1.836-3.672-4.284-3.672
            c-2.448,0-4.284,1.836-4.284,4.284S353.772,402.084,355.608,402.084z"/>
          <path d="M355.608,383.724c2.448,0,4.284-1.836,4.284-4.283l0,0c0-2.448-1.836-3.673-4.284-3.673
            c-2.448,0-4.284,1.836-4.284,4.284S353.772,383.724,355.608,383.724z"/>
        </g>
        <g className="coffee-upper">
          <path d="M359.28,435.132c21.42-1.224,41.004-11.628,54.468-27.54h-116.28
            C312.156,424.728,334.188,435.744,359.28,435.132z"/>
        </g>
      </g>
      }
      {state === 'done' &&
      <g className="base-covered">
        <path d="M531.252,540.396h-41.616c-1.836,0-3.672,1.836-3.672,3.672s1.836,3.672,3.672,3.672h5.508v32.436
          l-81.396,4.284c3.06-4.896,4.896-11.016,4.896-16.524c0-17.136-15.3-32.436-39.78-38.556c-3.672-0.612-6.12-3.672-6.12-7.344
          v-4.284h7.344c1.224,0,1.836-0.612,2.448-1.224c0.612-0.612,1.224-1.836,1.224-3.061l-4.896-48.96
          c-0.612-6.12-6.12-11.016-12.24-11.016h-21.42c-6.12,0-11.016,4.896-11.628,11.016l-4.896,48.96c0,1.225,0,1.836,1.224,3.061
          c0.612,0.611,1.836,1.224,2.448,1.224h7.344v4.284c0,3.672-2.448,6.731-6.12,7.344c-23.868,6.12-39.78,21.42-39.78,38.556
          c0,7.956,3.672,15.912,9.792,22.645l-26.928,1.224c-1.836,0-3.672,1.836-3.672,3.672v10.404c0,1.836,1.836,3.672,3.672,3.672h67.32
          h24.48h151.164c1.836,0,3.672-1.836,3.672-3.672v-58.14h7.956c1.836,0,3.672-1.836,3.672-3.672S533.088,540.396,531.252,540.396z
           M340.308,465.732c0-2.448,2.448-4.284,4.896-4.284h21.42c2.448,0,4.896,1.836,4.896,4.284l4.896,44.676h-40.392L340.308,465.732z
           M300.528,568.548c0-13.464,13.464-26.315,34.272-31.824c6.732-1.836,11.628-7.956,11.628-14.688v-4.284h6.12v32.437
          c0,17.136-11.628,23.256-22.032,23.256c-1.836,0-3.672,1.836-3.672,3.672s1.836,3.672,3.672,3.672
          c14.076,0,29.376-9.792,29.376-30.6v-32.437h6.12v4.284c0,6.731,4.896,12.852,11.628,14.688
          c20.196,5.509,34.272,17.748,34.272,31.824c0,6.12-2.448,11.628-7.344,17.136l-89.964,4.896
          C305.424,584.46,300.528,576.504,300.528,568.548z M343.368,602.208H279.72v-2.448l125.459-6.731l0,0l89.353-4.896v14.076H367.848
          H343.368z M515.34,602.208h-13.464V547.74h13.464V602.208z"/>
      </g>
      }
      {state === 'done' &&
      <g className="coffee-upper">
        <path d="M359.28,435.132c21.42-1.224,41.004-11.628,54.468-27.54h-116.28
          C312.156,424.728,334.188,435.744,359.28,435.132z"/>
      </g>
      }
    </svg>
    </div>
  )
}

export default class extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      current: countdownFrom,
      label: 'Click To Brew!',
      state: 'ready',
    }
  }
  render () {
    return (
      <div>
        <Head title="Coffee Timer" />
        <Nav />

        <style>{`
          body {
            background-color: #eee;
          }
          .container {
            background-color: white;
            border: 1px solid black;
            padding: 40px;
          }
          div#cup {
            width: 50%;
            float: left;
          }
          div#brew {
            margin-left: 50%;
          }
        `}</style>
        <div className="container">
          <div id="cup">
          {this.state.state === 'ready' &&
            <Cup onClick={() => {
              this.setState({ state: 'counting', current: countdownFrom });
              const counter = setInterval(() => {
                this.setState({ state: 'counting', current: this.state.current - 1});
                if (this.state.current <= 0) {
                  clearInterval(counter);
                  this.setState({ state: 'done', label: 'Done!' });
                }
              },
              1000);
            }} label={this.state.label} />
          }
          {this.state.state === 'counting' &&
            <Cup
              //onClick={() => {
              //this.setState({ state: 'ready', label: th });
              //}}
            label={`Coffee In ${this.state.current}..`} />
          }
          {this.state.state === 'done' &&
            <Cup onClick={() => {
              this.setState({ state: 'ready', label: 'Click To Brew!' });
              }}
              label={`Make Another Cup?`} />
          }
          </div>
          <div id="brew"><Brew state={this.state.state} /></div>
        </div>
        {this.state.state === 'done' &&
        <Sound
          url={"./static/ding.mp3"}
          playStatus={Sound.status.PLAYING}
          playFromPosition={0}
        />
        }
      </div>
    )
  }
}
